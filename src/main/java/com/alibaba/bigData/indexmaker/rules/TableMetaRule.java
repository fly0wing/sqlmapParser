package com.alibaba.bigData.indexmaker.rules;import com.alibaba.bigData.indexmaker.configuration.Commons;import com.alibaba.bigData.indexmaker.configuration.SqlType;import com.alibaba.bigData.indexmaker.objects.RuleCheckPara;import com.alibaba.bigData.indexmaker.objects.RuleCheckResult;import com.alibaba.bigData.indexmaker.sqlmeta.SqlInforIndex;import java.util.List;/** * Created with IntelliJ IDEA. * User: Administrator * Date: 14-6-9 * Time: 下午12:27 * 元数据检查rule */public class TableMetaRule extends AbstrctRule {    @Override    public RuleCheckResult check(RuleCheckPara ruleParameter) {        RuleCheckResult checkResult = null;        SqlType sqlType = ruleParameter.getSqlType();        if (sqlType.equals(SqlType.MYSQL)) {            checkResult = checkMysql(ruleParameter);        } else if (sqlType.equals(SqlType.ORACLE)) {            checkResult = checkOracle(ruleParameter);        }        return checkResult;    }    @Override    RuleCheckResult checkMysql(RuleCheckPara ruleParameter) {        RuleCheckResult checkResult = new RuleCheckResult(this.getRuleName(), true);        List<SqlInforIndex> indexList = ruleParameter.getIndexList();        for (SqlInforIndex idx : indexList) {            if (idx.getIndexName().toLowerCase().equals("primary")) {                if (idx.getColumuName().contains(",")) {                    checkResult.setSuccess(false);                    checkResult.setDetail(Commons.MULTI_PRIKEY_WARING_MSG);                    checkResult.setAdvice(Commons.MULTI_PRIKEY_DETAIL_MSG);                }                break;            }        }        return checkResult;    }    @Override    RuleCheckResult checkOracle(RuleCheckPara ruleParameter) {        return null;  //To change body of implemented methods use File | Settings | File Templates.    }}