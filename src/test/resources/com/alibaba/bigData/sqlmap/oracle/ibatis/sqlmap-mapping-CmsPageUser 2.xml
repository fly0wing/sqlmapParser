<?xml version='1.0' encoding="gb2312"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- WARNING: This is an autogenerated file -->

<sqlMap namespace="cms_CmsPageUser">        
        
    <resultMap class="CmsPageUser" id="CmsPageUser-result" >
        <result property="id"			javaType="java.lang.Long"		column="ID" />
        <result property="gmtCreate"	javaType="java.sql.Timestamp"	column="GMT_CREATE" />
        <result property="gmtModified"	javaType="java.sql.Timestamp"	column="GMT_MODIFIED" />
        <result property="pageId"		javaType="java.lang.Long"		column="PAGE_ID" />
        <result property="userId"		javaType="java.lang.String"		column="USER_ID" />
        <result property="permission"	javaType="java.lang.String"		column="PERMISSION" />
    </resultMap>

    <select id="MS-SELECT-CMSPAGEUSER-BY-PAGEID" resultClass="CmsPageUser" parameterClass="java.lang.Long"  resultMap="CmsPageUser-result" >
        <![CDATA[
            SELECT * FROM CMS_PAGE_USER WHERE PAGE_ID = #pageId#
        ]]>
    </select>
    
    <insert id="MS-INSERT-CMSPAGEUSER" parameterClass="CmsPageUser" >
	    <selectKey resultClass="java.lang.Long" keyProperty="id">
              SELECT SEQ_CMS_PAGE_USER.NEXTVAL AS id FROM DUAL
        </selectKey>
        <![CDATA[
            insert into CMS_PAGE_USER
              (ID  , GMT_CREATE  , GMT_MODIFIED  , PAGE_ID  , USER_ID  , PERMISSION )
            values
              (#id#  ,SYSDATE  , SYSDATE  , #pageId#  , #userId#  , #permission# )
        ]]>
    </insert>

    <delete id="MS-DELETECMSPAGEUSER-BY-PAGEID-PERMISSION" parameterClass="CmsPageUser"  >
        <![CDATA[
            delete from CMS_PAGE_USER where PERMISSION = #permission# AND PAGE_ID = #pageId#
        ]]>
    </delete>
    
    <select id="MS-SELECT-CMSPAGEUSER-BY-PAGEID-USERID" resultClass="java.lang.Long" parameterClass="java.util.Map" >
         SELECT count(*) FROM CMS_PAGE_USER WHERE PAGE_ID = #pageId# AND USER_ID=#userId# 
		 <isNotNull prepend="AND" property="permission">
			 PERMISSION = #permission#
		</isNotNull>
    </select>
    
    <select id="MS_SELECT_PAGEUSERID_BY_PAGEID_PERMISSION" resultClass="string" parameterClass="java.util.Map" >
         SELECT USER_ID FROM CMS_PAGE_USER 
         WHERE PAGE_ID = #pageId# AND PERMISSION = #permission#
    </select>
    
</sqlMap>
