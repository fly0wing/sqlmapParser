<?xml version='1.0' encoding="gb2312"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- WARNING: This is an autogenerated file -->

<sqlMap namespace="cms_CmsMaterialLib">

    <resultMap class="CmsMaterialLib" id="CmsMaterialLib-result" >
        <result property="gmtCreate"	javaType="java.sql.Timestamp"	column="GMT_CREATE" />
        <result property="gmtModified"	javaType="java.sql.Timestamp"	column="GMT_MODIFIED" />
        <result property="id"			javaType="java.lang.Long"		column="ID" />
        <result property="name"			javaType="java.lang.String"		column="NAME" />
		<result property="remark"      javaType="java.lang.String"     column="REMARK"/>
		<result property="status"      javaType="java.lang.String"     column="STATUS"/>
    </resultMap>

    <select id="getCmsMaterialLib" parameterClass="java.lang.Long" resultMap="CmsMaterialLib-result">
        <![CDATA[
            SELECT * FROM  CMS_MATERIAL_LIB where ID = #id#
        ]]>
    </select>

    <update id="updateCmsMaterialLib" parameterClass="CmsMaterialLib" >
        <![CDATA[
            update CMS_MATERIAL_LIB
            	set GMT_MODIFIED = SYSDATE ,
                    NAME = #name# ,
					REMARK=#remark# ,
					STATUS=#status# 				
            where  ID = #id#
        ]]>
    </update>

    <delete id="deleteCmsMaterialLib" parameterClass="java.lang.Long"  >
        <![CDATA[
            delete from CMS_MATERIAL_LIB where ID = #id#
        ]]>
    </delete>
 

	<insert id="addCmsMaterialLib" parameterClass="CmsMaterialLib">
		<selectKey resultClass="java.lang.Long" keyProperty="id">
			SELECT SEQ_CMS_MATERIAL_LIB.NEXTVAL AS ID FROM DUAL
		</selectKey>
		<![CDATA[
			INSERT INTO CMS_MATERIAL_LIB
				(GMT_CREATE , GMT_MODIFIED , ID , NAME  , REMARK, STATUS )
			values
				(SYSDATE , SYSDATE , #id# , #name# , #remark# , #status# )
		]]>
	</insert>

     <select id="selectCmsMaterialLib"  parameterClass="map"  resultClass="CmsMaterialLib" >
        <![CDATA[
            select * from CMS_MATERIAL_LIB where  1=1 
        ]]>    
         <dynamic>
			   <isNotEmpty prepend="AND" property = "status">
			  		STATUS = #status#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="name" >	
			        NAME = #name#
			  </isNotEmpty>			      
         </dynamic>
         
         <![CDATA[
            ORDER BY ID asc         
         ]]>
    </select>
    
    <select id="getMaterialLibCount" parameterClass="java.util.Map"
		resultClass="int">
        <![CDATA[
	      	SELECT count(*) FROM CMS_MATERIAL_LIB where 1=1 
	      ]]>
		<dynamic >
			<isNotEmpty prepend="and"  property="name">
				name like '%' || #name#||'%'
            </isNotEmpty>        
		</dynamic>
	</select>
	<select id="getMaterialLibByPage" parameterClass="java.util.Map"
		resultMap="CmsMaterialLib-result" resultClass="CmsMaterialLib">
        <![CDATA[ 
		SELECT * FROM (
		SELECT A.*,ROWNUM RN FROM 
		(
			SELECT T.*  FROM CMS_MATERIAL_LIB T 
 	      ]]>
		<dynamic prepend="WHERE">		
	        <isNotEmpty prepend="and"  property="name">
				name like '%' || #name#||'%'
            </isNotEmpty>
		</dynamic>
        <![CDATA[	           
			ORDER BY T.GMT_MODIFIED DESC
             ) A WHERE ROWNUM <= #offset# + #length#
         ) WHERE RN > #offset#
         ]]>
	</select>

</sqlMap>
